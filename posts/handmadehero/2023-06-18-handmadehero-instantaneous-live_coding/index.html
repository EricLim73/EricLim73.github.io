<!DOCTYPE html>
<html lang="en" style="font-size: 100%">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="Eric Lim">

  
  
  <meta name="description" content="Generic description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://EricLim73.github.io//images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://EricLim73.github.io//images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://EricLim73.github.io//images/favicon-16x16.png">

  
  
  <meta name="keywords" content=''>
  

  
  
  <link rel="stylesheet" href='/katex/katex.min.css'>
<script defer defer src='/katex/katex.min.js'></script>
<script defer src='/katex/contrib/auto-render.min.js'></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          throwOnError : false
        });
    });
</script>
  

  
  

  
  <meta property="og:title" content="[HandMadeHero] Instantaneous Live Coding" />
<meta property="og:description" content="Generic description" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://EricLim73.github.io/posts/handmadehero/2023-06-18-handmadehero-instantaneous-live_coding/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-18T21:29:52-05:00" />
<meta property="article:modified_time" content="2023-12-29T18:08:15+09:00" /><meta property="og:site_name" content="YodaModa" />



  
  <link rel="canonical" href="https://EricLim73.github.io/posts/handmadehero/2023-06-18-handmadehero-instantaneous-live_coding/">

  
  
  <meta itemprop="name" content="[HandMadeHero] Instantaneous Live Coding">
<meta itemprop="description" content="Generic description"><meta itemprop="datePublished" content="2023-06-18T21:29:52-05:00" />
<meta itemprop="dateModified" content="2023-12-29T18:08:15+09:00" />
<meta itemprop="wordCount" content="4944">
<meta itemprop="keywords" content="Game_Making,Handmade_Hero,Tips," />

  
  
  
    <link rel="stylesheet" href="/css/common.min.e562d763c6d0825495eb17de8b2c1d9800cf7c08db1c36accedf77a5fccfc4b9.css" integrity="sha256-5WLXY8bQglSV6xfeiywdmADPfAjbHDaszt93pfzPxLk=" crossorigin="anonymous">
  

  
  
    <link rel="stylesheet" href="/css/content.min.ba38eba94cb47fef9936258c42d11ff19fa9686a30b38e783773fe3f15eb44dc.css" integrity="sha256-ujjrqUy0f&#43;&#43;ZNiWMQtEf8Z&#43;paGows454N3P&#43;PxXrRNw=" crossorigin="anonymous">
  

  
  
  <title>[HandMadeHero] Instantaneous Live Coding - YodaModa</title>
  

  
  <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="[HandMadeHero] Instantaneous Live Coding"/>
<meta name="twitter:description" content="Generic description"/>


  


  <link rel="stylesheet" href="/css/single.min.be779f459ad7e3aaf8afd0f80c6a61ca6c50993f5f18512532100ac6d93f0fa9.css" integrity="sha256-vnefRZrX46r4r9D4DGphymxQmT9fGFElMhAKxtk/D6k=" crossorigin="anonymous">


  <link rel="stylesheet" href="/css/single.min.78a121b7d7a160420f9daab0ea13add66c37b9c44f27bba07b27207e2b0975d2.css" integrity="sha256-eKEht9ehYEIPnaqw6hOt1mw3ucRPJ7ugeycgfisJddI=" crossorigin="anonymous">


</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="https://EricLim73.github.io/">YodaModa</a>
    <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle theme">
        <svg width="2rem" height="2rem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496">
        <path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/>
        </svg>
    </button>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17,11H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm0,4H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2ZM11,9h6a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2ZM21,3H7A1,1,0,0,0,6,4V7H3A1,1,0,0,0,2,8V18a3,3,0,0,0,3,3H18a4,4,0,0,0,4-4V4A1,1,0,0,0,21,3ZM6,18a1,1,0,0,1-2,0V9H6Zm14-1a2,2,0,0,1-2,2H7.82A3,3,0,0,0,8,18V5H20Zm-9-4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Zm0,4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Z"/></svg>
</span>
      
      <a class="link" href="/posts/">Blog</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1">
<path d="M10.07031,20.50291a1.00008,1.00008,0,0,0-1.18115-.9834c-1.30908.24024-2.96191.27637-3.40137-.958a5.70754,5.70754,0,0,0-1.83691-2.415,1.20073,1.20073,0,0,1-.1665-.10938,1,1,0,0,0-.93067-.64551H2.54883a.99965.99965,0,0,0-1,.99512c-.00391.81543.811,1.33789,1.1416,1.51465a4.4408,4.4408,0,0,1,.92383,1.35937c.36426,1.02344,1.42285,2.57617,4.46582,2.376.001.03516.00195.06836.00244.09863l.00439.26758a1,1,0,0,0,2,0l-.00488-.31836C10.07715,21.4951,10.07031,21.22068,10.07031,20.50291Zm10.667-15.126c.03174-.125.063-.26367.09034-.41992a6.27792,6.27792,0,0,0-.40821-3.293,1.002,1.002,0,0,0-.61572-.58007c-.356-.12012-1.67041-.35645-4.18408,1.25a13.86918,13.86918,0,0,0-6.354,0C6.76221.751,5.45459.9658,5.10205,1.07908a.99744.99744,0,0,0-.63135.584,6.3003,6.3003,0,0,0-.40332,3.35644c.02442.12793.05078.2461.07813.35449A6.26928,6.26928,0,0,0,2.89014,9.20311a8.42168,8.42168,0,0,0,.04248.92187c.334,4.60254,3.334,5.98438,5.42431,6.459-.04345.125-.083.25878-.11816.40039a1.00023,1.00023,0,0,0,1.94238.47851,1.6784,1.6784,0,0,1,.46778-.87793.99947.99947,0,0,0-.5459-1.74512c-3.4541-.39453-4.95362-1.80175-5.1792-4.89843a6.61076,6.61076,0,0,1-.03369-.73828,4.25769,4.25769,0,0,1,.91943-2.71289,3.022,3.022,0,0,1,.1958-.23145.99988.99988,0,0,0,.188-1.02441,3.3876,3.3876,0,0,1-.15527-.55567A4.09356,4.09356,0,0,1,6.1167,3.06346a7.54263,7.54263,0,0,1,2.415,1.17968,1.00877,1.00877,0,0,0,.82764.13282,11.77716,11.77716,0,0,1,6.17285.001,1.00549,1.00549,0,0,0,.83056-.13769,7.572,7.572,0,0,1,2.40528-1.19043,4.03977,4.03977,0,0,1,.0874,1.57812,3.205,3.205,0,0,1-.16895.60743.9999.9999,0,0,0,.188,1.02441c.07715.08691.1543.18066.22363.26855A4.12186,4.12186,0,0,1,20,9.20311a7.03888,7.03888,0,0,1-.0376.77734c-.22021,3.05566-1.72558,4.46387-5.1958,4.85937a1,1,0,0,0-.54541,1.7461,1.63079,1.63079,0,0,1,.46631.9082,3.06079,3.06079,0,0,1,.09229.81934v2.334C14.77,21.2949,14.77,21.78025,14.77,22.00291a1,1,0,1,0,2,0c0-.2168,0-.69238.00977-1.33984V18.31346a4.8815,4.8815,0,0,0-.15479-1.31153,4.25638,4.25638,0,0,0-.11621-.416,6.51258,6.51258,0,0,0,5.44531-6.42383A8.69677,8.69677,0,0,0,22,9.20311,6.13062,6.13062,0,0,0,20.7373,5.37693Z"/></svg>
</span>
      
      <a class="link" href="https://github.com/EricLim73">GitHub</a>
    </span>
    
  </nav>
</header>
<hr class="head-rule"></hr>
    
<main id="main" class="post">
  
  <div class="post-heading">
    <h1 class="post-title">[HandMadeHero] Instantaneous Live Coding</h1>
    <div class="publish-metadata">
      
      <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      18 June 2023
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.4998 5.49994L18.3282 8.32837M3 20.9997L3.04745 20.6675C3.21536 19.4922 3.29932 18.9045 3.49029 18.3558C3.65975 17.8689 3.89124 17.4059 4.17906 16.9783C4.50341 16.4963 4.92319 16.0765 5.76274 15.237L17.4107 3.58896C18.1918 2.80791 19.4581 2.80791 20.2392 3.58896C21.0202 4.37001 21.0202 5.63634 20.2392 6.41739L8.37744 18.2791C7.61579 19.0408 7.23497 19.4216 6.8012 19.7244C6.41618 19.9932 6.00093 20.2159 5.56398 20.3879C5.07171 20.5817 4.54375 20.6882 3.48793 20.9012L3 20.9997Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          4944 words
        </span>
      
      
      
        
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 7V12L14.5 13.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          ~10 mins
        </span>
      
    </div>
  </div>

  
  <div>
    
    <a class="link tag" href='https://EricLim73.github.io/tags/game_making'>#Game_Making</a>
    
    <a class="link tag" href='https://EricLim73.github.io/tags/handmade_hero'>#Handmade_Hero</a>
    
    <a class="link tag" href='https://EricLim73.github.io/tags/tips'>#Tips</a>
    
    <br></br>
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li><a href="#end">End</a></li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content numbered-subtitles">
    
    <h1 id="hot-reload-준비">Hot Reload 준비</h1>
<p>유니티 엔진에서 코드를 수정하고 저장을 하면 해당 변화가 적용되기까지 시간이 걸리고 그동안 엔진을 만질 수 없는 상태가 된다. 그냥 실행하는 도중에 코드의 변화를 즉각적으로
반영할 수 있다면 매우 편할 것이다. 그걸 구현하는 방법을 소개한다. 물론 포로토타입 수준의 코드로 그저 기능구현만을 초점으로 만들어진 코드들이다.</p>
<p><code>Hot Reload</code>를 구현하기 가장 간단한 방법은 해당 코드를 DLL로 만들고 이 라이브러리를 연결하는 방식이다. DLL을 로딩할 때 해당 파일의 마지막 편집 시간을 기준으로 매번 체크했을 때 변했다면 가장 최신 DLL로 링크를 하는 방식이다. 우리의 경우 플랫폼 코드와 플랫폼-independent한 코드(aka 게임코드)가 있고, 후자를 동적라이브러리로 컴파일하고 플랫폼 코드에서는 루프를 돌때마다 DLL의 상태를 확인하여 마지막으로 연결한 DLL과의 편집시간 정보를 비교하면 된다. 이렇게 된다면 &ldquo;게임코드가 사용하는 메모리를 어떻게 처리해야되나&rdquo; 라는 의문이 생긴다(나는 그랬다). 근데 생각해보면 어차피 게임코드가 사용하는 메모리는 플랫폼 코드에서 한번에 동적할당해서 넘겨준다. 해당 메모리에 대해 게임코드는 적절히 어디를 어떤 시스템에서 사용할 지 정하는 정도지 추가적인 할당이나 해제를 하지 않는다. 다시 말해 게임코드가 사용하는 메모리는 그대로고 게임코드만 바뀌는 방식이다. 이런게 안되는 상황이 존재하기는 하지만 일단 지금 상태에서는 문제가 없다는 전제로 만든다.</p>
<p>우선 플랫폼 코드에서 <code>#include &quot;게임코드.cpp&quot;</code>를 지우고 <code>#include &quot;게임코드.h&quot;</code>는 남긴다. 이제 빌드 배치파일에서 <code>cl</code>을 통해 게임코드를 따로 컴파일 한다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="c1">:COMMON LINKER SWITCHES</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">link</span><span class="p">=</span>                   -opt:ref               <span class="p">&amp;</span>:: Remove unused functions
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">link</span><span class="p">=</span><span class="nv">%link%</span>             -incremental:no        <span class="p">&amp;</span>:: Perform full link each time
</span></span><span class="line"><span class="cl">                                                    <span class="p">:</span><span class="c1">: ^ This makes recompiling dynamic dll game code possible </span>
</span></span><span class="line"><span class="cl">                                                   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="c1">: DLL LINKER SWITCHES</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">dll_link</span><span class="p">=</span>               /EXPORT:GameUpdateAndRender
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">dll_link</span><span class="p">=</span><span class="nv">%dll_link%</span>     /EXPORT:GameGetSoundSamples
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="c1">: No Optimization (slow) -Od</span>
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="c1">: All Optimization (fast) -O2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cl -Od <span class="nv">%compiler%</span> -DWIN32_LOWLEVEL=1 <span class="nv">%defines%</span> <span class="nv">%code_path%</span>lowlevel.cpp -LD /link /pdb:lowlevel<span class="nv">%random%</span>.pdb <span class="nv">%link%</span> <span class="nv">%dll_link%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cl -Od <span class="nv">%compiler%</span> -DWIN32_LOWLEVEL=1 <span class="nv">%defines%</span> -Fmwin32_lowlevel.map  <span class="nv">%code_path%</span>win32_lowlevel.cpp <span class="nv">%win32Libs%</span> /link <span class="nv">%link%</span> -subsystem:windows,6.0
</span></span></code></pre></div><p>윗줄이 게임코드를 동적으로 컴파일하는 명령이고 밑에 줄이 플랫폼코드를 컴파일시킨다. <code>-incremental:no</code> 옵션을 통해 매번 확실하게 컴파일 되도록 설정해준다. <code>-LD</code> 옵션이 동적라이브러리를 만드는 <code>cl</code>컴파일러 옵션이다. 컴파일 단계에서 게임코드를 링킹하지 않는다. 실제로 링킹은 플랫폼.cpp 안에서 <code>LoadLibraryA()</code>함수를 통해서 진행된다(컨트롤러 라이브러리를 연결시킬때 사용한 함수다).
동적라이브러리도 실행파일(exe)파일과 다를게 없다. 다만 그안에 들어있는 함수들을 실행하기 위해서 접근하는 함수테이블이 있다. <code>GetProcAddress()</code>함수가 이 함수테이블을 찾아가서 목표함수를 뽑아온다. DLL안에서는 어떤 함수를 내보내는 함수로 사용할지 선언해줘야 된다.</p>
<ul>
<li>비주얼 스튜디오에서는 <code>__declspec(dllexport)</code>를 통해 보낼 수 있다.</li>
<li><code>build.bat</code>에서 컴파일타임에 선언해줄 수 있다.</li>
</ul>
<p>두가지 방법 중 후자를 사용한다(이건 취향문제라고 한다). 전자의 경우 굳이 불편한 부분을 따지자면 모든 환경에서 해당 기능을 부르기 위해 동일한 네이밍을 쓰지 않아서 번거로운 부분이 존재한다. 현재 게임코드에 있는 함수라고 해봐야 사운드 함수와 렌더린 함수 2개 뿐인지라 그냥 컴파일 배치파일에 쓰겠다. <code>DLL LINKER SWITCHES</code>밑에 적힌대로 하면 된다.
컴파일 스크립트를 통해 두함수를 내보낸다고 선언했기 때문에 기존에 붙힌 <code>local</code>, 즉 <code>static</code>를 빼준다(원래 하나의 파일에 있던(유니티빌드로 그런 취급) 내용들이여서 붙어있었다). 게임코드로 분류되어 있는 파일관련 함수 3개의 경우 다른 방식으로 넘겨받을 생각이다(일단 <code>static</code>은 빼준다).</p>
<p>이제 본격적으로 리팩토링을 한다. 우선 게임코드 헤더파일에 내보내는 두 함수를 <code>Xinput</code>때처럼 함수포인터 선언으로 지정해준다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Render, Sound, Input, Frame Data, and so on are all processed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define GAME_UPDATE_AND_RENDER(name) void name(thread_context* Thread, game_memory *Memory, game_offscreen_buffer* Buffer, game_input *Input)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="nf">GAME_UPDATE_AND_RENDER</span><span class="p">(</span><span class="n">game_update_and_render</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define GAME_GET_SOUND_SAMPLES(name) void name(thread_context* Thread, game_memory *Memory, game_sound_output_buffer *SoundBuffer)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="nf">GAME_GET_SOUND_SAMPLES</span><span class="p">(</span><span class="n">game_get_sound_samples</span><span class="p">);</span>
</span></span></code></pre></div><p>게임코드.cpp에서의 구현도 다음과 같이 바꿔준다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">GAME_UPDATE_AND_RENDER</span><span class="p">(</span><span class="n">GameUpdateAndRender</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">GAME_GET_SOUND_SAMPLES</span><span class="p">(</span><span class="n">GameGetSoundSamples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>이렇게 하면 헤더를 받고있는 플랫폼 파일에서는 함수형태를 알 수 있고, 실제 구현은 동적 라이브러리에서 구현되있는 형태가 된다. 이제 이걸 플랫폼 함수에서 불러오는 방법이다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">win32_game_code</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// NOTE(EricLim): Enclosing the module handle inside this struct
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// will make it easy for us to free and load a new game code
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// anywhere we want (in the scope of where our struct variable made lives)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">HMODULE</span> <span class="n">GameCodeDLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILETIME</span> <span class="n">DLLLastTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">game_update_and_render</span><span class="o">*</span> <span class="n">GameUpdateAndRender</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">game_get_sound_samples</span><span class="o">*</span> <span class="n">GameGetSoundSamples</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">b32</span> <span class="n">IsValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">internal</span> <span class="n">win32_game_code</span>
</span></span><span class="line"><span class="cl"><span class="nf">Win32LoadGameCode</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">SourceDLLName</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TempDLLName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">win32_game_code</span> <span class="n">Result</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    <span class="n">Result</span><span class="p">.</span><span class="n">DLLLastTime</span> <span class="o">=</span> <span class="n">Win32GetLastWriteTime</span><span class="p">(</span><span class="n">SourceDLLName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">CopyFile</span><span class="p">(</span><span class="n">SourceDLLName</span><span class="p">,</span> <span class="n">TempDLLName</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Result</span><span class="p">.</span><span class="n">GameCodeDLL</span> <span class="o">=</span> <span class="n">LoadLibraryA</span><span class="p">(</span><span class="n">TempDLLName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">Result</span><span class="p">.</span><span class="n">GameCodeDLL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Result</span><span class="p">.</span><span class="n">GameUpdateAndRender</span> <span class="o">=</span>  
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">game_update_and_render</span><span class="o">*</span><span class="p">)</span><span class="n">GetProcAddress</span><span class="p">(</span><span class="n">Result</span><span class="p">.</span><span class="n">GameCodeDLL</span><span class="p">,</span> <span class="s">&#34;GameUpdateAndRender&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Result</span><span class="p">.</span><span class="n">GameGetSoundSamples</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">game_get_sound_samples</span><span class="o">*</span><span class="p">)</span><span class="n">GetProcAddress</span><span class="p">(</span><span class="n">Result</span><span class="p">.</span><span class="n">GameCodeDLL</span><span class="p">,</span> <span class="s">&#34;GameGetSoundSamples&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Result</span><span class="p">.</span><span class="n">IsValid</span> <span class="o">=</span> <span class="p">(</span><span class="n">Result</span><span class="p">.</span><span class="n">GameUpdateAndRender</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                          <span class="n">Result</span><span class="p">.</span><span class="n">GameGetSoundSamples</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Result</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Result</span><span class="p">.</span><span class="n">GameUpdateAndRender</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Result</span><span class="p">.</span><span class="n">GameGetSoundSamples</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">internal</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">Win32UnloadGameCode</span><span class="p">(</span><span class="n">win32_game_code</span> <span class="o">*</span><span class="n">GameCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">GameCodeDLL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">FreeLibrary</span><span class="p">(</span><span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">GameCodeDLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">GameCodeDLL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">IsValid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">GameUpdateAndRender</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">GameCode</span><span class="o">-&gt;</span><span class="n">GameGetSoundSamples</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>기존 <code>XInput</code>라이브러리를 연결할 때와 비슷한 구조다. 따로 <code>win32_game_code</code> 구조를 만들어서 사용한다. 이제 플랫폼 코드의 메인함수 안에서 이 구조의 객체를 불러 사용하면 된다. (<code>Win32GetLastWriteTime</code>는 밑에서 설명한다&hellip;.)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">WinMain</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">win32_game_code</span> <span class="n">Game</span> <span class="o">=</span> <span class="n">Win32LoadGameCode</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">Game</span><span class="p">.</span><span class="n">GameUpdateAndRender</span><span class="p">(...);</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">Game</span><span class="p">.</span><span class="n">GameGetSoundSamples</span><span class="p">(...);</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>이제 앞서 언급한 파일 읽기, 쓰기, 해제에 해당하는 기능들이다. 사실 이 함수들은 플랫폼에 종속되는 기능들이여서 플랫폼 코드에 구현된다. 근데 게임코드도 해당 기능을 쓸 일이 많다. 지금 코드 구조는 게임코드가 하나의 서비스로 플랫폼 코드에 연결되는 형식인데 이 상황에서 어떻게 플랫폼의 함수를 넘기느냐의 문제다. 가장 간단한 방법은 함수 포인터 자체를 넘겨버리는 거다. 우선 게임코드 헤더에 함수포인터 형식을 지정해준다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// NOTE(EricLim): Services that the platform layer provides to the game.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#if LOWLEVEL_INTERNAL
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">struct</span>
</span></span><span class="line"><span class="cl"><span class="nc">debug_read_file_result</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">u32</span> <span class="n">ContentsSize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span><span class="o">*</span> <span class="n">Contents</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// NOTE(EricLim): Note that for loading game code dynamically,
</span></span></span><span class="line"><span class="cl"><span class="c1">// this part is no longer &#34;internal&#34;. This declaration lives
</span></span></span><span class="line"><span class="cl"><span class="c1">// inside this header (which our platform layer takes) and the 
</span></span></span><span class="line"><span class="cl"><span class="c1">// definitions for these functions are also inside platform layer.
</span></span></span><span class="line"><span class="cl"><span class="c1">// Our game code is now an DLL. BUT we take our game memory from
</span></span></span><span class="line"><span class="cl"><span class="c1">// platform layer as a pointer where it gets allocated and populated.
</span></span></span><span class="line"><span class="cl"><span class="c1">// That means that we can use pointers to access things from exe inside DLL.  
</span></span></span><span class="line"><span class="cl"><span class="c1">// SO we will maintain only function pointers
</span></span></span><span class="line"><span class="cl"><span class="c1">//-
</span></span></span><span class="line"><span class="cl"><span class="c1">// NOTE(EricLim): Reading Files consist of...
</span></span></span><span class="line"><span class="cl"><span class="c1">// 1. Get File handle to open file [CreateFileA(...)]
</span></span></span><span class="line"><span class="cl"><span class="c1">// 2. Get File size [GetFileSizeEx(...)]
</span></span></span><span class="line"><span class="cl"><span class="c1">// 3. Allocate memory [VirtualAlloc(...)]
</span></span></span><span class="line"><span class="cl"><span class="c1">// 4. Read data into memory destination [ReadFile(...)] 
</span></span></span><span class="line"><span class="cl"><span class="c1">// 5. Clos created File handle [CloseHandle(...)]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define DEBUG_PLATFORM_FREE_FILE_MEMORY(name) void name(thread_context* Thread, void* Memory)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="nf">DEBUG_PLATFORM_FREE_FILE_MEMORY</span><span class="p">(</span><span class="n">debug_platform_free_file_memory</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define DEBUG_PLATFORM_READ_ENTIRE_FILE(name) debug_read_file_result name (thread_context* Thread, char* Filename)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="nf">DEBUG_PLATFORM_READ_ENTIRE_FILE</span><span class="p">(</span><span class="n">debug_platform_read_entire_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define DEBUG_PLATFORM_WRTIE_ENTIRE_FILE(name) b32 name(thread_context* Thread, char* Filename, u32 MemorySize, void* Memory)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="nf">DEBUG_PLATFORM_WRTIE_ENTIRE_FILE</span><span class="p">(</span><span class="n">debug_platform_write_entire_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//-
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#endif
</span></span></span></code></pre></div><p>어느정도 진행하고 정리하는 도중이라 <code>thread_context</code> 같이 정리안한 내용이 있는데 이건 지금은 넘긴다. 이렇게 함수 포인터를 지정하면 해당 헤더를 포함하는 플랫폼코드에서 함수구현 형태를 바꿔주면 된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DEBUG_PLATFORM_FREE_FILE_MEMORY</span><span class="p">(</span><span class="n">DEBUGPlatformFreeFileMemory</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">Memory</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// NOTE(EricLim): dSize param should always be 0 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// when using MEM_RELEASE option 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">VirtualFree</span><span class="p">(</span><span class="n">Memory</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MEM_RELEASE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DEBUG_PLATFORM_READ_ENTIRE_FILE</span><span class="p">(</span><span class="n">DEBUGPlatformReadEntireFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">debug_read_file_result</span> <span class="n">Result</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// NOTE(EricLim): We only want to read the asset file.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// &#34;OPEN_EXISTING&#34; ensures that we are reading from an existing file.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// The last param is ignored when we do &#34;GENERIC_READ&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">HANDLE</span> <span class="n">FileHandle</span> <span class="o">=</span> <span class="n">CreateFileA</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">GENERIC_READ</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">FILE_SHARE_READ</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="mi">0</span><span class="p">,</span> <span class="n">OPEN_EXISTING</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">FileHandle</span> <span class="o">!=</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LARGE_INTEGER</span> <span class="n">FileSize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">GetFileSizeEx</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">FileSize</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Result</span><span class="p">.</span><span class="n">Contents</span> <span class="o">=</span> <span class="n">VirtualAlloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">FileSize</span><span class="p">.</span><span class="n">QuadPart</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                           <span class="n">MEM_RESERVE</span><span class="o">|</span><span class="n">MEM_COMMIT</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                           <span class="n">PAGE_READWRITE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">Result</span><span class="p">.</span><span class="n">Contents</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// NOTE(EricLim): Last param is for dealing with
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// asynchronous behavior (will do later, not now)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// &#34;ReadFile&#34; can only read up to maximum size from 32bits
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// so FileSize (which is 64bits right now) can cause issues if \
</span></span></span><span class="line"><span class="cl"><span class="c1">                // bigger than &#34;ReadFile&#34;&#39;s capacity.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">u32</span> <span class="n">FileSize32</span> <span class="o">=</span> <span class="n">SafeTruncateUInt64</span><span class="p">(</span><span class="n">FileSize</span><span class="p">.</span><span class="n">QuadPart</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="n">DWORD</span> <span class="n">BytesRead</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">ReadFile</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">,</span> <span class="n">Result</span><span class="p">.</span><span class="n">Contents</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                             <span class="n">FileSize32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BytesRead</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">FileSize32</span> <span class="o">==</span> <span class="n">BytesRead</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// NOTE(EricLim): File read SUCCESS !!!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">Result</span><span class="p">.</span><span class="n">ContentsSize</span> <span class="o">=</span> <span class="n">BytesRead</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// We will just free the allocated memory right away
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="c1">// NOTE(EricLim): IF READ FAILS!!!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="c1">// and reset it to zero. --&gt; Reconize as allocation failure
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">DEBUGPlatformFreeFileMemory</span><span class="p">(</span><span class="n">Thread</span><span class="p">,</span> <span class="n">Result</span><span class="p">.</span><span class="n">Contents</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Result</span><span class="p">.</span><span class="n">Contents</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// TODO(EricLim): Dignostics -&gt; Failed to VirtualAlloc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// TODO(EricLim): Dignostics -&gt; Failed to get file size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">CloseHandle</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// TODO(EricLim): Dignostics -&gt; Failed to retrieve file handle
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span><span class="n">Result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// TODO(EricLim): DO NOT USE THIS FOR SHIPPING CODE!!!
</span></span></span><span class="line"><span class="cl"><span class="c1">// It has no backup for failed writes, resulting corrupted saves.
</span></span></span><span class="line"><span class="cl"><span class="c1">// You would do something like make a two seperate file and write 
</span></span></span><span class="line"><span class="cl"><span class="c1">// to them interchangably to remedy failed write issue.
</span></span></span><span class="line"><span class="cl"><span class="c1">// You can also make temp files to write on and then change that 
</span></span></span><span class="line"><span class="cl"><span class="c1">// temp file name as original, then delete the original(this is still dangerous).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEBUG_PLATFORM_WRTIE_ENTIRE_FILE</span><span class="p">(</span><span class="n">DEBUGPlatformWriteEntireFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">b32</span> <span class="n">Result</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// NOTE(EricLim): We only want to read the asset file.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// &#34;OPEN_EXISTING&#34; ensures that we are reading from an existing file.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// The last param is ignored when we do &#34;GENERIC_READ&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">HANDLE</span> <span class="n">FileHandle</span> <span class="o">=</span> <span class="n">CreateFileA</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">GENERIC_WRITE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                    <span class="n">CREATE_ALWAYS</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">FileHandle</span> <span class="o">!=</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">DWORD</span> <span class="n">BytesWritten</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">WriteFile</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">,</span> <span class="n">Memory</span><span class="p">,</span> <span class="n">MemorySize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BytesWritten</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// NOTE(EricLim): File Write SUCCESS !!!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Result</span> <span class="o">=</span> <span class="p">(</span><span class="n">MemorySize</span> <span class="o">==</span> <span class="n">BytesWritten</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">CloseHandle</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// TODO(EricLim): Dignostics -&gt; Failed to retrieve file handle
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span><span class="n">Result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>이제 이함수들을 포인터로 DLL에 넘겨줘야된다. 기존에 넘기던 <code>game_memory</code>에 같이 넘기도록 한다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// NOTE(EricLim): Permanent will consist of core data sets
</span></span></span><span class="line"><span class="cl"><span class="c1">// that don&#39;t get | should not get destroyed.
</span></span></span><span class="line"><span class="cl"><span class="c1">// Transient is mainly used for once | several times and 
</span></span></span><span class="line"><span class="cl"><span class="c1">// has no problem getting deleted in any given time. 
</span></span></span><span class="line"><span class="cl"><span class="c1">// Some examples for the latter option can be 
</span></span></span><span class="line"><span class="cl"><span class="c1">// Animations, Sounds, etc. 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span>
</span></span><span class="line"><span class="cl"><span class="nc">game_memory</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">u64</span> <span class="n">PermanentStorageSize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// NOTE(EricLim): &#34; PermanentStorage&#34; is required to be cleared at startUp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">u64</span> <span class="n">TransientStorageSize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">b32</span> <span class="n">IsInitialized</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span><span class="o">*</span> <span class="n">PermanentStorage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span><span class="o">*</span> <span class="n">TransientStorage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">debug_platform_free_file_memory</span><span class="o">*</span> <span class="n">DEBUGPlatformFreeFileMemory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">debug_platform_read_entire_file</span><span class="o">*</span> <span class="n">DEBUGPlatformReadEntireFile</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">debug_platform_write_entire_file</span><span class="o">*</span> <span class="n">DEBUGPlatformWriteEntireFile</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>이제 넘기는 단계에서 포인터를 연결해주면 된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Inside WinMian() 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">game_memory</span> <span class="n">GameMemory</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">PermanentStorageSize</span> <span class="o">=</span> <span class="n">MegaBytes</span><span class="p">(</span><span class="mi">64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">TransientStorageSize</span> <span class="o">=</span> <span class="n">GigaBytes</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// NOTE(EricLim): The following three function pointers
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// are used for the DLL game code to process its memory
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">GameMemory</span><span class="p">.</span><span class="n">DEBUGPlatformFreeFileMemory</span> <span class="o">=</span> <span class="n">DEBUGPlatformFreeFileMemory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">DEBUGPlatformReadEntireFile</span> <span class="o">=</span> <span class="n">DEBUGPlatformReadEntireFile</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">DEBUGPlatformWriteEntireFile</span> <span class="o">=</span> <span class="n">DEBUGPlatformWriteEntireFile</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// NOTE(EricLim): window state stores game memory for 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// saving the world state and dynamic loop editing and MORE!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Win32State</span><span class="p">.</span><span class="n">TotalSize</span> <span class="o">=</span> <span class="p">(</span><span class="n">GameMemory</span><span class="p">.</span><span class="n">PermanentStorageSize</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                                <span class="n">GameMemory</span><span class="p">.</span><span class="n">TransientStorageSize</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Win32State</span><span class="p">.</span><span class="n">GameMemoryBlock</span> <span class="o">=</span> <span class="n">VirtualAlloc</span><span class="p">(</span><span class="n">BaseAddress</span><span class="p">,</span> <span class="p">(</span><span class="n">size_t</span><span class="p">)</span><span class="n">Win32State</span><span class="p">.</span><span class="n">TotalSize</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                <span class="n">MEM_RESERVE</span><span class="o">|</span><span class="n">MEM_COMMIT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                <span class="n">PAGE_READWRITE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">PermanentStorage</span> <span class="o">=</span> <span class="n">Win32State</span><span class="p">.</span><span class="n">GameMemoryBlock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameMemory</span><span class="p">.</span><span class="n">TransientStorage</span> <span class="o">=</span> <span class="p">((</span><span class="n">u8</span><span class="o">*</span><span class="p">)</span><span class="n">GameMemory</span><span class="p">.</span><span class="n">PermanentStorage</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">GameMemory</span><span class="p">.</span><span class="n">PermanentStorageSize</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>여기서 이전과 다르게 <code>Win32State</code>라는게 추가되어 사용되는데 이건 밑에서 설명한다. 이제 게임코드에서 파일관련 함수들을 사용한다면 <code>DEBUGPlatformFreeFileMemory(...)</code>와 같은 형태로 작성하면 된다. 이렇게 구현한 기능은 C++에서의 <code>VTable</code>기능을 모방한 것이다. 차이가 있다면 C++에서 블랙박스 취급이던 기능을 두눈으로 보고 우리가 마음대로 조절할 수 있다는 점이다.</p>
<p>여기까지 작성하면 <code>Hot Reload</code>기능의 준비단계를 끝낸거다. 구현에 앞서 여기까지의 과정을 거치면서 링킹오류에서 함수의 이름이 뒤틀린 문자열 뭉치로 보이는 현상이 있었다. 이는 <code>Name-Mangling</code>이라는 기능으로, 컴파일러가 같은 이름의 다른 함수형태를 구분하기 위한 방법이다. 이는 C++에서의 대부분의 기능을 수행하는데 사용된다고 한다. 우리 입장에서는 딱히 쓸 일이 없기 때문에 이 기능을 해제할 수 있다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#if defined __cplusplus
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">extern</span> <span class="s">&#34;C&#34;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">GAME_UPDATE_AND_RENDER</span><span class="p">(</span><span class="n">GameUpdateAndRender</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ... 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#if defined __cplusplus
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">extern</span> <span class="s">&#34;C&#34;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">GAME_GET_SOUND_SAMPLES</span><span class="p">(</span><span class="n">GameGetSoundSamples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ... 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>이렇게 함수위에 선언해주는 것으로 해결가능하다. 실제로 제대로 DLL설정을 했는지 확인하고 싶다면 VisualStudio 패키지의 기능 중 <code>dumpbin</code>을 사용하면 알 수 있다. 명령 프롬프트에서 <code>dumpbin /export [path]/target.dll</code>을 치면 된다.</p>
<h1 id="hot-reload-구현">Hot-Reload 구현</h1>
<p>이제 진짜로 <code>Hot-Reload</code> 구현이다. 게임루프에 진입하기 전에 <code>GameCode</code> 변수로 한번 로딩을 한다. 그후 게임 루프에서 해당 DLL파일의 마지막 쓰기시간을 받아온다. 이제 기존에 받아온 DLL의 쓰기 시간과 최근에 받은 DLL의 쓰기 시간을 비교하고 차이가 있다면 기존 DLL을 <em>Unload</em>하고 새로운 DLL로 다시 로드한다. 이러한 형태의 코드가 작성된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="p">{</span>   <span class="c1">// inside game loop from WinMian()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FILETIME</span> <span class="n">NewDLLWriteTime</span> <span class="o">=</span> <span class="n">Win32GetLastWriteTime</span><span class="p">(</span><span class="n">SourceGameCodeDLLFullPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">CompareFileTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">NewDLLWriteTime</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GameCode</span><span class="p">.</span><span class="n">DLLLastTime</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">GameCode</span><span class="p">.</span><span class="n">DLLLastTime</span> <span class="o">=</span> <span class="n">NewDLLWriteTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Win32UnloadGameCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">GameCode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">GameCode</span> <span class="o">=</span> <span class="n">Win32LoadGameCode</span><span class="p">(</span><span class="n">SourceGameCodeDLLFullPath</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">TempGameCodeDLLFullPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>               
</span></span></code></pre></div><p><code>FILETIME</code>의 경우 Win32API에서 제공하는 파일 시간용 데이터타입이다. 여기서 우리가 직접만들어야 되는 기능은 다음과 같다.</p>
<ul>
<li><code>SourceGameCodeDLLFullPath</code>와 같은 파일 경로를 뽑는 함수</li>
<li>받아온 시간 비교한는 함수 <code>CompareFileTime(&amp;NewDLLWriteTime, &amp;GameCode.DLLLastTime)</code></li>
<li>마지막 쓰기 시간을 받아오는 함수 <code>Win32GetLastWriteTime(SourceGameCodeDLLFullPath)</code></li>
</ul>
<p><code>CompareFileTime</code>의 경우 Win32에서 제공하는 함수다. 마지막 쓰기 시간을 받아오는 함수는 이미 만들었어야되는 함수 중 하나다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">FILETIME</span>
</span></span><span class="line"><span class="cl"><span class="nf">Win32GetLastWriteTime</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">Filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILETIME</span> <span class="n">LastWriteTime</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="cp">#if 0</span><span class="c">
</span></span></span><span class="line"><span class="cl"><span class="c">    // NOTE(EricLim): This is some what not good(?)
</span></span></span><span class="line"><span class="cl"><span class="c">    // bc we always open file whenever we run this function
</span></span></span><span class="line"><span class="cl"><span class="c">    WIN32_FIND_DATA FindData;
</span></span></span><span class="line"><span class="cl"><span class="c">    HANDLE FindHandle = FindFirstFileA(Filename, &amp;FindData);
</span></span></span><span class="line"><span class="cl"><span class="c">    if (FindHandle != INVALID_HANDLE_VALUE)
</span></span></span><span class="line"><span class="cl"><span class="c">    {
</span></span></span><span class="line"><span class="cl"><span class="c">        LastWriteTime = FindData.ftLastWriteTime;
</span></span></span><span class="line"><span class="cl"><span class="c">        FindClose(FindHandle);
</span></span></span><span class="line"><span class="cl"><span class="c">    }
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="c1">// NOTE(EricLim): Using &#34;GetFileAttributeEx()&#34; can skip the while 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// &#34;opening a file and reading info about it&#34; stage and fetch file
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// attribute right away
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="c1">// see MSDN for guide
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">WIN32_FILE_ATTRIBUTE_DATA</span> <span class="n">Data</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">GetFileAttributesExA</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">GetFileExInfoStandard</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="o">&amp;</span><span class="n">Data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LastWriteTime</span> <span class="o">=</span> <span class="n">Data</span><span class="p">.</span><span class="n">ftLastWriteTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">LastWriteTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Win32 프로그래밍이다. 보면 <code>#if</code>블록으로 사용안함 처리한 부분이 있다. 이는 원래 초기에 작성할 당시 사용한 방법인데 사실 파일의 작성시간만을 알고 싶다면 굳이 파일을 오픈할 필요가 없다. <code>GetFileAttributesExA()</code>를 사용하면 파일을 열지 않고 해당 파일의 속성을 확인할 수 있다.
다음은 DLL파일경로를 받는 함수다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">CALLBACK</span> 
</span></span><span class="line"><span class="cl"><span class="nf">WinMain</span><span class="p">(</span><span class="n">HINSTANCE</span> <span class="n">Instance</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">HINSTANCE</span> <span class="n">PrevInsatnce</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">LPSTR</span> <span class="n">CommandLine</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">ShowCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">win32_state</span> <span class="n">Win32State</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    <span class="n">Win32GetExeFileName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Win32State</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">SourceGameCodeDLLFullPath</span><span class="p">[</span><span class="n">WIN32_STATE_FILE_NAME_COUNT</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">Win32BuildExePathFileName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Win32State</span><span class="p">,</span> <span class="s">&#34;lowlevel.dll&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                              <span class="k">sizeof</span><span class="p">(</span><span class="n">SourceGameCodeDLLFullPath</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                              <span class="n">SourceGameCodeDLLFullPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">TempGameCodeDLLFullPath</span><span class="p">[</span><span class="n">WIN32_STATE_FILE_NAME_COUNT</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">Win32BuildExePathFileName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Win32State</span><span class="p">,</span> <span class="s">&#34;lowlevel_temp.dll&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                              <span class="k">sizeof</span><span class="p">(</span><span class="n">TempGameCodeDLLFullPath</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                              <span class="n">TempGameCodeDLLFullPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>이런 방식으로 사용된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">internal</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">Win32BuildExePathFileName</span><span class="p">(</span><span class="n">win32_state</span><span class="o">*</span> <span class="n">State</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">Filename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="kt">int</span> <span class="n">DestCount</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">Dest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// NOTE(EricLim): -1 for removing null terminator. This will be added
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// while we concat the strings
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// !!!!!!BUT!!!!!!!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Since now we are reading it looping through &#34;until&#34; that null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// terminator, we don&#39;t need to -1 this fella
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">CatStrings</span><span class="p">(</span><span class="n">State</span><span class="o">-&gt;</span><span class="n">OnePastLastEXEFilenameSlash</span> <span class="o">-</span> <span class="n">State</span><span class="o">-&gt;</span><span class="n">EXEFilename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">State</span><span class="o">-&gt;</span><span class="n">EXEFilename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">StringLength</span><span class="p">(</span><span class="n">Filename</span><span class="p">),</span> <span class="n">Filename</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">DestCount</span><span class="p">,</span> <span class="n">Dest</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">internal</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">CatStrings</span><span class="p">(</span><span class="n">size_t</span> <span class="n">SourceACount</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">SourceA</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">           <span class="n">size_t</span> <span class="n">SourceBCount</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">SourceB</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">size_t</span> <span class="n">DestCount</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">Dest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// TODO(EricLim): Dest size bounding test
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">Index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="n">Index</span> <span class="o">&lt;</span> <span class="n">SourceACount</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">         <span class="o">++</span><span class="n">Index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="n">Dest</span><span class="o">++</span> <span class="o">=</span> <span class="o">*</span><span class="n">SourceA</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">Index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="n">Index</span> <span class="o">&lt;</span> <span class="n">SourceBCount</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">         <span class="o">++</span><span class="n">Index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="n">Dest</span><span class="o">++</span> <span class="o">=</span> <span class="o">*</span><span class="n">SourceB</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="n">Dest</span><span class="o">++</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>이기능이 필요한 이유는 <code>Win32GetLastWriteTime()</code>에서 쓰인 <code>FindFirstFileA() </code>||<code>GetFileAttributesExA()</code> 때문이다. <code>LoadLibraryA()</code>와 다르게 <code>FindFirstFileA()</code>함수는 <em>exe</em>폴더의 위치가 아닌 지정된 작업디렉토리에서 탐색을 한다. 현재 작업 디렉토리는 에셋을 저장하는 폴더로 설정되어 있어서 DLL을 업데이트 할 때 못찾고 반영을 못하는 문제가 생긴다. 이를 해결하기 위해 애초에 위치하는 경로를 그대로 전달해 주기 위해 필요한 기능이다.</p>
<p>기억나는 대로 다시 정리하다보니 순서가 조금 섞였는데 앞서 작성한 컴파일러 스크립트에 이런 옵션이 추가된걸 볼 수 있다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">cl -Od <span class="nv">%compiler%</span> -DWIN32_LOWLEVEL=1 <span class="nv">%defines%</span> <span class="nv">%code_path%</span>lowlevel.cpp -LD /link /pdb:lowlevel<span class="nv">%random%</span>.pdb <span class="nv">%link%</span> <span class="nv">%dll_link%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cl -Od <span class="nv">%compiler%</span> -DWIN32_LOWLEVEL=1 <span class="nv">%defines%</span> -Fmwin32_lowlevel.map  <span class="nv">%code_path%</span>win32_lowlevel.cpp <span class="nv">%win32Libs%</span> /link <span class="nv">%link%</span> -subsystem:windows,6.0
</span></span></code></pre></div><p><code>Hot-Reload</code>기능을 구현한 지금 <code>/pdb:lowlevel%random%.pdb</code> 없이 제대로 디버깅을 실행할 수 없기 때문이다. 게임코드의 변화를 반영하기 위해 매번 컴파일을 한다면 그때마다 매번 생성되는 파일 중 디버깅을 위한 <code>pdb</code>파일이 있을 것이다. 제대로 디버깅을 하기 위해서 이렇게 업데이트된 생성파일들에 접근하게 되는데 <code>pdb</code>파일의 경우 디버깅 도중이면 잠겨있는 경우가 대부분이다. 사실 DLL파일 자체가 사용 중이면 잠기는 현상이 있어서 이를 해결하기 위해 로딩 도중에 임시 DLL 파일을 만들어서 그걸 통해서 연결하는 편법을 쓰기는 했다. <code>pdb</code>가 잠기는 경우는 비주얼스튜디오 디버거의 경우 그렇고 다른 디버거의 경우 다를 수 있다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="c1">// inside Win32LoadGameCode() 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">CopyFile</span><span class="p">(</span><span class="n">SourceDLLName</span><span class="p">,</span> <span class="n">TempDLLName</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Result</span><span class="p">.</span><span class="n">GameCodeDLL</span> <span class="o">=</span> <span class="n">LoadLibraryA</span><span class="p">(</span><span class="n">TempDLLName</span><span class="p">);</span>
</span></span></code></pre></div><p>이렇게 <code>pdb</code>의 이름을 바꾸면 기존에 디버거가 먹고 있던 <code>pdb</code>와 다른 업데이트된 <code>pdb</code>가 생겨서 그걸 통해 디버깅을 진행하는 방식이다. 문제는 이렇게 하면 쓸데없이 <code>pdb</code>파일이 늘어나기 때문에 스크립트를 통해 삭제해준다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="k">del</span> *.pdb <span class="p">&gt;</span> NUL <span class="mi">2</span><span class="p">&gt;</span> NUL
</span></span></code></pre></div><p>근데 이게 좀 시간이 지나고 정리하는 내용이여서 정확히 어떤 과정을 거쳤는지 찾아봐야지만 나는 실행하면 <code>pdb</code>가 안생긴다. 아마 컴파일러 옵션으로 <code>-Z7</code>을 넣어서 그런거 같은데 정확하지 않아 찾아봐야될 것 같다.</p>
<p>대충 이러한 방식을 통해 돌리면 즉각적으로 변화를 반영하는 <code>Hot-Reload</code>의 구현이 끝났다.</p>
<h2 id="end">End</h2>
<blockquote>
<p>[Reference]<br>
<a href="https://guide.handmadehero.org/code/">HandmadHero</a></p>
</blockquote>

    
  </article>

  <button onclick="topFunction()" id="back-to-top" title="Go to top">Back to Top</button>

  

<div id="sharingbuttons">
    
    
    <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=%5bHandMadeHero%5d%20Instantaneous%20Live%20Coding&amp;url=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="mailto:?subject=%5bHandMadeHero%5d%20Instantaneous%20Live%20Coding&amp;body=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_self" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f&amp;resubmit=true&amp;title=%5bHandMadeHero%5d%20Instantaneous%20Live%20Coding" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="whatsapp://send?text=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f&amp;t=%5bHandMadeHero%5d%20Instantaneous%20Live%20Coding" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=%5bHandMadeHero%5d%20Instantaneous%20Live%20Coding&amp;url=https%3a%2f%2fEricLim73.github.io%2fposts%2fhandmadehero%2f2023-06-18-handmadehero-instantaneous-live_coding%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"/></svg>
        </div>
      </div>
    </a>
    
</div>
  <div class="paginator">
    
    <a class="link" href="https://EricLim73.github.io/posts/c_c&#43;&#43;/assortrock_2021_c&#43;&#43;_course/2023-04-21-assortrock_2021_c&#43;&#43;_course-tree/" title="[AssortRock_2021_C&#43;&#43;_Course] Tree">← prev</a>
    
    
    <a class="link" href="https://EricLim73.github.io/posts/howtomarkdown/mermaid-diagrams/" title="Mermaid Diagrams">next →</a>
    
  </div>
  <div class="comment">
    
    
    
      <script src="https://giscus.app/client.js"
    data-repo="EricLim73/blogDiscussions"
    data-repo-id="R_kgDOK-ebpA"
    data-category="General"
    data-category-id="DIC_kwDOK-ebpM4CcDSi"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="transparent_dark"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
  
  </div>
  
  
</main>

    <footer id="footer">
  <div>
    <span>Powered by  <a class=link href=https://gohugo.io target=_blank rel=noopener>Hugo</a> | 
Theme <a class=link href=https://github.com/michaelneuper/hugo-texify3 target=_blank rel=noopener>TeXify3</a>
</span>
  </div>
  <div>
    <span>Copyright © 2023 Eric Lim</span>
  </div>
</footer>

  </div>

  
  <script src='https://EricLim73.github.io/js/script.js' defer></script>

  
  

  
  

  
  

</body>

</html>
